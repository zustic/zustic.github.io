"use strict";(globalThis.webpackChunkzustic_doc=globalThis.webpackChunkzustic_doc||[]).push([[1348],{8359(n,e,r){r.r(e),r.d(e,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>s,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"tutorial-extras/query-plugins","title":"Plugins","description":"Lifecycle hooks and side-effect management","source":"@site/docs/tutorial-extras/query-plugins.md","sourceDirName":"tutorial-extras","slug":"/tutorial-extras/query-plugins","permalink":"/docs/tutorial-extras/query-plugins","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/tutorial-extras/query-plugins.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"Plugins","description":"Lifecycle hooks and side-effect management"},"sidebar":"tutorialSidebar","previous":{"title":"Middleware","permalink":"/docs/tutorial-extras/query-middleware"},"next":{"title":"Advanced Features & Optimization","permalink":"/docs/tutorial-extras/query-advanced"}}');var i=r(4848),o=r(8453);const s={sidebar_position:4,title:"Plugins",description:"Lifecycle hooks and side-effect management"},a="Plugin System",l={},c=[{value:"Plugin Fundamentals",id:"plugin-fundamentals",level:2},{value:"Type Definition",id:"type-definition",level:3},{value:"Simple Example",id:"simple-example",level:3},{value:"Real-World Plugin Examples",id:"real-world-plugin-examples",level:2},{value:"1. Comprehensive Logging Plugin",id:"1-comprehensive-logging-plugin",level:3},{value:"2. Analytics Plugin",id:"2-analytics-plugin",level:3},{value:"3. Error Tracking Plugin (Sentry Integration)",id:"3-error-tracking-plugin-sentry-integration",level:3},{value:"4. State Persistence Plugin",id:"4-state-persistence-plugin",level:3},{value:"5. Performance Monitoring Plugin",id:"5-performance-monitoring-plugin",level:3},{value:"6. DevTools Integration Plugin",id:"6-devtools-integration-plugin",level:3},{value:"7. User Feedback Plugin",id:"7-user-feedback-plugin",level:3},{value:"8. Request/Response Transformation Plugin",id:"8-requestresponse-transformation-plugin",level:3},{value:"Plugin with Middleware",id:"plugin-with-middleware",level:2},{value:"Production Example",id:"production-example",level:2},{value:"Using in React",id:"using-in-react",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"\u2705 Do&#39;s",id:"-dos",level:3},{value:"\u274c Don&#39;ts",id:"-donts",level:3},{value:"Advanced Patterns",id:"advanced-patterns",level:2},{value:"Conditional Plugins",id:"conditional-plugins",level:3},{value:"Plugin with Configuration",id:"plugin-with-configuration",level:3}];function d(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"plugin-system",children:"Plugin System"})}),"\n",(0,i.jsx)(e.p,{children:"Plugins extend Zustic Query with lifecycle hooks for side effects like logging, analytics, error tracking, and custom state management. Plugins can also include middleware for advanced control."}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"plugin-fundamentals",children:"Plugin Fundamentals"}),"\n",(0,i.jsx)(e.p,{children:"Plugins provide hooks into the query lifecycle to perform side effects and reactions without modifying core query logic."}),"\n",(0,i.jsx)(e.h3,{id:"type-definition",children:"Type Definition"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"export type ApiPlugin = {\n  name: string\n\n  // Called once when API is created\n  onInit?: (api: {\n    baseQuery: any\n    endpoints: any\n  }) => void\n\n  // Before query execution\n  beforeQuery?: (ctx: PluginContext) => void | Promise<void>\n\n  // Middleware-level control (optional)\n  middleware?: ApiMiddleware\n\n  // After successful execution\n  afterQuery?: (\n    result: any,\n    ctx: PluginContext\n  ) => void | Promise<void>\n\n  // Global error handler\n  onError?: (\n    error: any,\n    ctx: PluginContext\n  ) => void | Promise<void>\n}\n\ntype PluginContext = {\n  arg: any       // Query arguments\n  def: any       // Endpoint definition\n  get: any       // Get store state\n  set: any       // Update store state\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"simple-example",children:"Simple Example"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"const helloPlugin: ApiPlugin = {\n  name: 'hello',\n\n  onInit: (api) => {\n    console.log('\u2705 Hello plugin initialized')\n  },\n\n  beforeQuery: (ctx) => {\n    console.log('\ud83d\udd35 Query starting:', ctx.def.endpoint)\n  },\n\n  afterQuery: (result, ctx) => {\n    console.log('\ud83d\udfe2 Query completed:', ctx.def.endpoint)\n  },\n\n  onError: (error, ctx) => {\n    console.error('\ud83d\udd34 Query error:', ctx.def.endpoint, error)\n  },\n}\n\nconst api = createApi({\n  baseQuery: myBaseQuery,\n  plugins: [helloPlugin],\n  endpoints: (builder) => ({\n    getUsers: builder.query({\n      query: () => ({ url: '/users' })\n    })\n  })\n})\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"real-world-plugin-examples",children:"Real-World Plugin Examples"}),"\n",(0,i.jsx)(e.h3,{id:"1-comprehensive-logging-plugin",children:"1. Comprehensive Logging Plugin"}),"\n",(0,i.jsx)(e.p,{children:"Track all query activity for debugging:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"const loggingPlugin: ApiPlugin = {\n  name: 'logging',\n\n  onInit: (api) => {\n    console.log(\n      '%c\ud83d\ude80 Logging plugin initialized',\n      'color: green; font-weight: bold'\n    )\n    console.log('Endpoints:', Object.keys(api.endpoints))\n  },\n\n  beforeQuery: (ctx) => {\n    console.log(\n      `%c[${ctx.def.endpoint}]%c Starting query`,\n      'color: blue; font-weight: bold',\n      'color: gray'\n    )\n    console.log('Arguments:', ctx.arg)\n    console.log('Timestamp:', new Date().toISOString())\n  },\n\n  afterQuery: (result, ctx) => {\n    console.log(\n      `%c[${ctx.def.endpoint}]%c Success`,\n      'color: green; font-weight: bold',\n      'color: gray'\n    )\n    if (result.data) {\n      console.log('Response:', result.data)\n    }\n    console.log('Timestamp:', new Date().toISOString())\n  },\n\n  onError: (error, ctx) => {\n    console.error(\n      `%c[${ctx.def.endpoint}]%c Error`,\n      'color: red; font-weight: bold',\n      'color: gray'\n    )\n    console.error('Error:', error)\n    console.error('Arguments:', ctx.arg)\n    console.error('Timestamp:', new Date().toISOString())\n  },\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"2-analytics-plugin",children:"2. Analytics Plugin"}),"\n",(0,i.jsx)(e.p,{children:"Send usage events to analytics service:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"const analyticsPlugin: ApiPlugin = {\n  name: 'analytics',\n\n  beforeQuery: (ctx) => {\n    // Track query execution\n    if (window.gtag) {\n      window.gtag('event', 'api_query', {\n        endpoint: ctx.def.endpoint,\n        method: ctx.arg.method || 'GET',\n        timestamp: Date.now(),\n      })\n    }\n\n    // Also track with custom analytics\n    if (window.analytics) {\n      window.analytics.track('API Query', {\n        endpoint: ctx.def.endpoint,\n        type: ctx.def.type, // 'query' or 'mutation'\n      })\n    }\n  },\n\n  afterQuery: (result, ctx) => {\n    // Track successful queries\n    if (window.gtag) {\n      window.gtag('event', 'api_success', {\n        endpoint: ctx.def.endpoint,\n        responseSize: JSON.stringify(result.data).length,\n        timestamp: Date.now(),\n      })\n    }\n  },\n\n  onError: (error, ctx) => {\n    // Track errors\n    if (window.gtag) {\n      window.gtag('event', 'api_error', {\n        endpoint: ctx.def.endpoint,\n        errorMessage: error?.message,\n        errorStatus: error?.status,\n        timestamp: Date.now(),\n      })\n    }\n\n    // Send to custom error tracking\n    if (window.errorReporter) {\n      window.errorReporter.captureException(error, {\n        tags: { endpoint: ctx.def.endpoint },\n      })\n    }\n  },\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"3-error-tracking-plugin-sentry-integration",children:"3. Error Tracking Plugin (Sentry Integration)"}),"\n",(0,i.jsx)(e.p,{children:"Send production errors to monitoring service:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"const sentryPlugin: ApiPlugin = {\n  name: 'sentry',\n\n  onError: (error, ctx) => {\n    // Only capture server errors (5xx)\n    if (error?.status && error.status >= 500) {\n      if (window.Sentry) {\n        window.Sentry.captureException(error, {\n          level: 'error',\n          tags: {\n            service: 'api',\n            endpoint: ctx.def.endpoint,\n            method: ctx.arg.method,\n          },\n          extra: {\n            arguments: ctx.arg,\n            errorStatus: error.status,\n            timestamp: new Date().toISOString(),\n          },\n        })\n      }\n    }\n\n    // Log client errors separately\n    if (error?.status && error.status >= 400 && error.status < 500) {\n      console.warn('Client error:', {\n        status: error.status,\n        endpoint: ctx.def.endpoint,\n      })\n    }\n  },\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"4-state-persistence-plugin",children:"4. State Persistence Plugin"}),"\n",(0,i.jsx)(e.p,{children:"Auto-save and restore query results:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"const persistencePlugin: ApiPlugin = {\n  name: 'persistence',\n\n  onInit: (api) => {\n    console.log('\ud83d\udce6 Restoring persisted state...')\n    \n    // Restore all persisted queries on app init\n    const keys = Object.keys(localStorage)\n    keys.forEach(key => {\n      if (key.startsWith('query_')) {\n        try {\n          const cached = JSON.parse(localStorage.getItem(key)!)\n          const endpoint = key.replace('query_', '')\n          console.log(\n            `\u2705 Restored ${endpoint} from localStorage`,\n            cached.data\n          )\n        } catch (e) {\n          console.error(`Failed to restore ${key}`, e)\n        }\n      }\n    })\n  },\n\n  afterQuery: (result, ctx) => {\n    // Only persist successful responses\n    if (!result.error && ctx.def.persist !== false) {\n      const key = `query_${ctx.def.endpoint}`\n\n      try {\n        localStorage.setItem(\n          key,\n          JSON.stringify({\n            data: result.data,\n            timestamp: Date.now(),\n            endpoint: ctx.def.endpoint,\n          })\n        )\n        console.log(`\ud83d\udcbe Persisted ${ctx.def.endpoint}`)\n      } catch (e) {\n        // Handle quota exceeded\n        console.error('Storage quota exceeded', e)\n      }\n    }\n  },\n\n  onError: (error, ctx) => {\n    // Clear corrupted cache on error\n    const key = `query_${ctx.def.endpoint}`\n    localStorage.removeItem(key)\n    console.log(`\ud83d\uddd1\ufe0f  Cleared cached ${ctx.def.endpoint}`)\n  },\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"5-performance-monitoring-plugin",children:"5. Performance Monitoring Plugin"}),"\n",(0,i.jsx)(e.p,{children:"Track query performance metrics:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"const performancePlugin: ApiPlugin = {\n  name: 'performance',\n\n  beforeQuery: (ctx) => {\n    // Mark start time\n    const startMark = `${ctx.def.endpoint}_start`\n    performance.mark(startMark)\n  },\n\n  afterQuery: (result, ctx) => {\n    // Measure time\n    const startMark = `${ctx.def.endpoint}_start`\n    const endMark = `${ctx.def.endpoint}_end`\n\n    performance.mark(endMark)\n    performance.measure(\n      `query_${ctx.def.endpoint}`,\n      startMark,\n      endMark\n    )\n\n    const measure = performance.getEntriesByName(\n      `query_${ctx.def.endpoint}`\n    )[0] as any\n\n    console.log(\n      `\u23f1\ufe0f  ${ctx.def.endpoint}: ${measure.duration.toFixed(2)}ms`\n    )\n\n    // Send to monitoring\n    if (window.gtag) {\n      window.gtag('event', 'page_view', {\n        custom_metric_duration: measure.duration,\n        custom_metric_endpoint: ctx.def.endpoint,\n      })\n    }\n  },\n\n  onError: (error, ctx) => {\n    // Clear marks on error\n    performance.clearMarks(`${ctx.def.endpoint}_start`)\n    performance.clearMarks(`${ctx.def.endpoint}_end`)\n  },\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"6-devtools-integration-plugin",children:"6. DevTools Integration Plugin"}),"\n",(0,i.jsx)(e.p,{children:"Enable debugging with browser developer tools:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"const devtoolsPlugin: ApiPlugin = {\n  name: 'devtools',\n\n  onInit: (api) => {\n    if (process.env.NODE_ENV === 'development') {\n      console.log(\n        '%c\ud83d\udd27 Query DevTools available',\n        'color: purple; font-weight: bold'\n      )\n      // Store reference for debugging\n      ;(window as any).__ZUSTIC_QUERY__ = {\n        api,\n        queries: new Map(),\n        mutations: new Map(),\n      }\n    }\n  },\n\n  beforeQuery: (ctx) => {\n    if ((window as any).__ZUSTIC_QUERY__) {\n      const store = (window as any).__ZUSTIC_QUERY__\n      const key = `${ctx.def.endpoint}_${Date.now()}`\n      store.queries.set(key, {\n        endpoint: ctx.def.endpoint,\n        arguments: ctx.arg,\n        startTime: Date.now(),\n      })\n    }\n  },\n\n  afterQuery: (result, ctx) => {\n    if ((window as any).__ZUSTIC_QUERY__) {\n      const store = (window as any).__ZUSTIC_QUERY__\n      store.lastResult = {\n        endpoint: ctx.def.endpoint,\n        data: result.data,\n        timestamp: Date.now(),\n      }\n    }\n  },\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"7-user-feedback-plugin",children:"7. User Feedback Plugin"}),"\n",(0,i.jsx)(e.p,{children:"Collect user feedback on API issues:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"const feedbackPlugin: ApiPlugin = {\n  name: 'feedback',\n\n  onError: (error, ctx) => {\n    // Only show feedback prompt for significant errors\n    if (error?.status === 500 || error?.status === 503) {\n      const userEmail = localStorage.getItem('userEmail')\n      \n      if (confirm('An error occurred. Would you like to report it?')) {\n        // Send feedback\n        fetch('/api/feedback', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({\n            endpoint: ctx.def.endpoint,\n            error: error?.message,\n            timestamp: new Date().toISOString(),\n            userEmail,\n          }),\n        }).catch(console.error)\n      }\n    }\n  },\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"8-requestresponse-transformation-plugin",children:"8. Request/Response Transformation Plugin"}),"\n",(0,i.jsx)(e.p,{children:"Transform data between API and app formats:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"const transformPlugin: ApiPlugin = {\n  name: 'transform',\n\n  afterQuery: (result, ctx) => {\n    // Transform snake_case API responses to camelCase\n    if (result.data && ctx.def.transformResponse) {\n      result.data = ctx.def.transformResponse(result.data)\n    }\n\n    // Format dates\n    if (result.data) {\n      walkObject(result.data, (obj, key, value) => {\n        if (key.includes('date') && typeof value === 'string') {\n          obj[key] = new Date(value)\n        }\n      })\n    }\n  },\n}\n\nfunction walkObject(obj: any, callback: Function) {\n  Object.keys(obj).forEach(key => {\n    const value = obj[key]\n    callback(obj, key, value)\n    \n    if (typeof value === 'object' && value !== null) {\n      walkObject(value, callback)\n    }\n  })\n}\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"plugin-with-middleware",children:"Plugin with Middleware"}),"\n",(0,i.jsx)(e.p,{children:"Plugins can include middleware for fine-grained request control:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"const advancedPlugin: ApiPlugin = {\n  name: 'advanced',\n\n  middleware: async (ctx, next) => {\n    console.log('Middleware running in plugin')\n    return await next()\n  },\n\n  beforeQuery: (ctx) => {\n    console.log('Before hook')\n  },\n\n  afterQuery: (result, ctx) => {\n    console.log('After hook')\n  },\n}\n\nconst api = createApi({\n  baseQuery: myBaseQuery,\n  plugins: [advancedPlugin],\n  endpoints: (builder) => ({ /* ... */ })\n})\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"production-example",children:"Production Example"}),"\n",(0,i.jsx)(e.p,{children:"Complete plugin setup for production:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"import { createApi } from 'zustic/query'\n\ninterface User {\n  id: number\n  name: string\n  email: string\n}\n\n// ============ Plugins ============\n\nconst loggingPlugin: ApiPlugin = {\n  name: 'logging',\n  beforeQuery: (ctx) => {\n    console.log(`[${ctx.def.endpoint}] Starting`)\n  },\n  afterQuery: (result, ctx) => {\n    console.log(`[${ctx.def.endpoint}] Success`)\n  },\n  onError: (error, ctx) => {\n    console.error(`[${ctx.def.endpoint}] Error:`, error)\n  },\n}\n\nconst analyticsPlugin: ApiPlugin = {\n  name: 'analytics',\n  beforeQuery: (ctx) => {\n    if (window.gtag) {\n      window.gtag('event', 'api_query', {\n        endpoint: ctx.def.endpoint,\n      })\n    }\n  },\n}\n\nconst sentryPlugin: ApiPlugin = {\n  name: 'sentry',\n  onError: (error, ctx) => {\n    if (error?.status >= 500 && window.Sentry) {\n      window.Sentry.captureException(error, {\n        tags: { endpoint: ctx.def.endpoint },\n      })\n    }\n  },\n}\n\n// ============ API Setup ============\n\nexport const api = createApi({\n  baseQuery: async (params) => {\n    try {\n      const res = await fetch(\n        `https://api.example.com${params.url}`,\n        {\n          method: params.method || 'GET',\n          headers: params.headers || {},\n          body: params.body ? JSON.stringify(params.body) : undefined,\n        }\n      )\n\n      if (!res.ok) {\n        return { error: { status: res.status } }\n      }\n\n      return { data: await res.json() }\n    } catch (error) {\n      return { error: { status: 0, message: String(error) } }\n    }\n  },\n\n  clashTimeout: 5 * 60 * 1000,\n\n  plugins: [loggingPlugin, analyticsPlugin, sentryPlugin],\n\n  endpoints: (builder) => ({\n    getUsers: builder.query({\n      query: () => ({ url: '/users' }),\n    }),\n\n    createUser: builder.mutation({\n      query: (user: Omit<User, 'id'>) => ({\n        url: '/users',\n        method: 'POST',\n        body: user,\n      }),\n    }),\n  }),\n})\n\nexport const { useGetUsersQuery, useCreateUserMutation } = api\n"})}),"\n",(0,i.jsx)(e.h3,{id:"using-in-react",children:"Using in React"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-tsx",children:"import { useGetUsersQuery, useCreateUserMutation } from './api'\n\nexport function App() {\n  // Plugins automatically:\n  // - Log all queries\n  // - Send analytics events\n  // - Track errors to Sentry\n  const { data: users, isLoading } = useGetUsersQuery()\n  const [createUser] = useCreateUserMutation()\n\n  if (isLoading) return <div>Loading...</div>\n\n  return (\n    <div>\n      {users?.map(user => (\n        <div key={user.id}>{user.name}</div>\n      ))}\n    </div>\n  )\n}\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsx)(e.h3,{id:"-dos",children:"\u2705 Do's"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Keep plugins focused"})," \u2014 One concern per plugin"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Use for side effects"})," \u2014 Logging, analytics, tracking"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Handle errors gracefully"})," \u2014 Don't throw"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Make plugins optional"})," \u2014 Users should be able to disable them"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Document plugin behavior"})," \u2014 Explain what it does"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Test plugins independently"})," \u2014 Test each plugin separately"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"-donts",children:"\u274c Don'ts"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Don't modify core logic"})," \u2014 Use for side effects only"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Don't throw errors"})," \u2014 Always handle gracefully"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Don't make blocking operations"})," \u2014 Keep them async-aware"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Don't assume other plugins"})," \u2014 Don't depend on execution order"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Don't leak memory"})," \u2014 Clean up resources in errors"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Don't hardcode config"})," \u2014 Make plugins configurable"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"advanced-patterns",children:"Advanced Patterns"}),"\n",(0,i.jsx)(e.h3,{id:"conditional-plugins",children:"Conditional Plugins"}),"\n",(0,i.jsx)(e.p,{children:"Load plugins based on environment:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"const plugins =\n  process.env.NODE_ENV === 'production'\n    ? [loggingPlugin, analyticsPlugin, sentryPlugin]\n    : [loggingPlugin, devtoolsPlugin]\n\nconst api = createApi({\n  baseQuery: myBaseQuery,\n  plugins,\n  endpoints: (builder) => ({ /* ... */ }),\n})\n"})}),"\n",(0,i.jsx)(e.h3,{id:"plugin-with-configuration",children:"Plugin with Configuration"}),"\n",(0,i.jsx)(e.p,{children:"Make plugins configurable:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"const createLoggingPlugin = (options: {\n  verbose?: boolean\n  filter?: (endpoint: string) => boolean\n}): ApiPlugin => ({\n  name: 'logging',\n  beforeQuery: (ctx) => {\n    if (options.filter && !options.filter(ctx.def.endpoint)) {\n      return\n    }\n\n    if (options.verbose) {\n      console.log('Full details:', ctx.arg)\n    } else {\n      console.log('Query:', ctx.def.endpoint)\n    }\n  },\n})\n\nconst api = createApi({\n  baseQuery: myBaseQuery,\n  plugins: [\n    createLoggingPlugin({ verbose: true, filter: (e) => !e.includes('health') }),\n  ],\n  endpoints: (builder) => ({ /* ... */ }),\n})\n"})})]})}function u(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(d,{...n})}):d(n)}},8453(n,e,r){r.d(e,{R:()=>s,x:()=>a});var t=r(6540);const i={},o=t.createContext(i);function s(n){const e=t.useContext(o);return t.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:s(n.components),t.createElement(o.Provider,{value:e},n.children)}}}]);